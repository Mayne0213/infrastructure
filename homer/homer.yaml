---
apiVersion: v1
kind: Namespace
metadata:
  name: homer
---
apiVersion: v1
kind: ConfigMap
metadata:
  name: homer-config
  namespace: homer
data:
  config.yml: |
    # Homepage configuration
    # See https://fontawesome.com/v5/search for icons options

    title: "Mayne Services"
    subtitle: "내가 만든 웹사이트 모음"
    logo: "https://raw.githubusercontent.com/WalkxCode/homer/main/public/logo.png"
    icon: "https://raw.githubusercontent.com/WalkxCode/homer/main/public/logo.png"
    
    # Optional message
    message:
      # url: "https://homer-demo.netlify.app/" # Can fetch information from an endpoint
      style: "is-dark" # See https://bulma.io/documentation/components/message/#colors for styling options.
      title: "환영합니다!"
      icon: "fa fa-grin"
      content: "아래 링크를 통해 각 서비스에 접근할 수 있습니다."
    
    # Optional navbar
    links:
      - name: "GitHub"
        icon: "fab fa-github"
        url: "https://github.com"
        target: "_blank" # optional html a tag target attribute
      - name: "Portfolio"
        icon: "fas fa-user"
        url: "https://minjo0213.kro.kr"
        target: "_blank"
    
    # Optional footer
    footer: '<p>Made with <span class="has-text-danger">❤️</span> using <a href="https://bulma.io/">bulma</a>, <a href="https://vuejs.org/">vuejs</a> & <a href="https://fontawesome.com/">font awesome</a> // Fork me on <a href="https://github.com/bastienwirtz/homer"><i class="fab fa-github-alt"></i></a></p>'
    
    # Optional CSS
    stylesheet: "" # path to custom CSS
    
    # Optional theme
    theme: "default" # 'default' or one of the themes available in 'src/assets/themes'
    
    # Optional colors
    colors:
      light:
        highlight-primary: "#3367d6"
        highlight-secondary: "#4285f4"
        highlight-hover: "#5a95f5"
        background: "#f5f5f5"
        card-background: "#ffffff"
        text: "#363636"
        text-header: "#ffffff"
        text-title: "#303030"
        text-subtitle: "#424242"
        card-shadow: rgba(0, 0, 0, 0.1)
        link: "#3273dc"
        link-hover: "#363636"
      dark:
        highlight-primary: "#3367d6"
        highlight-secondary: "#4285f4"
        highlight-hover: "#5a95f5"
        background: "#131313"
        card-background: "#2d2d2d"
        text: "#eaeaea"
        text-header: "#ffffff"
        text-title: "#fafafa"
        text-subtitle: "#f5f5f5"
        card-shadow: rgba(0, 0, 0, 0.4)
        link: "#3273dc"
        link-hover: "#ffdd57"
    
    # Optional websocket
    websocket:
      enabled: false
      url: "ws://localhost:8080"
      reconnectInterval: 5000
    
    # Optional services
    services:
      - name: "프로젝트"
        icon: "fas fa-code"
        items:
          - name: "Jovies"
            logo: "https://jovies.kro.kr/favicon.ico"
            subtitle: "영화 추천 서비스"
            tag: "production"
            keywords: "영화 movie"
            url: "https://jovies.kro.kr"
            target: "_blank"
          - name: "Portfolio"
            logo: "https://minjo0213.kro.kr/favicon.ico"
            subtitle: "포트폴리오 사이트"
            tag: "production"
            keywords: "포트폴리오 portfolio"
            url: "https://minjo0213.kro.kr"
            target: "_blank"
          - name: "Todo"
            logo: "https://todo0213.kro.kr/favicon.ico"
            subtitle: "할 일 관리 앱"
            tag: "production"
            keywords: "할일 todo"
            url: "https://todo0213.kro.kr"
            target: "_blank"
          - name: "Jaejadle"
            logo: "https://jaejadle.kro.kr/favicon.ico"
            subtitle: "교회 웹사이트"
            tag: "production"
            keywords: "교회 church"
            url: "https://jaejadle.kro.kr"
            target: "_blank"
          - name: "Joossam"
            logo: "https://joossameng.kro.kr/favicon.ico"
            subtitle: "OMR 채점 API"
            tag: "production"
            keywords: "omr api"
            url: "https://joossameng.kro.kr"
            target: "_blank"
      
      - name: "개발 환경"
        icon: "fas fa-code-branch"
        items:
          - name: "Jovies Dev"
            logo: "https://dev.jovies.kro.kr/favicon.ico"
            subtitle: "Jovies 개발 환경"
            tag: "dev"
            keywords: "개발 dev"
            url: "https://dev.jovies.kro.kr"
            target: "_blank"
          - name: "Todo Dev"
            logo: "https://dev.todo0213.kro.kr/favicon.ico"
            subtitle: "Todo 개발 환경"
            tag: "dev"
            keywords: "개발 dev"
            url: "https://dev.todo0213.kro.kr"
            target: "_blank"
          - name: "Jaejadle Dev"
            logo: "https://dev.jaejadle.kro.kr/favicon.ico"
            subtitle: "Jaejadle 개발 환경"
            tag: "dev"
            keywords: "개발 dev"
            url: "https://dev.jaejadle.kro.kr"
            target: "_blank"
          - name: "Portfolio Dev"
            logo: "https://dev.minjo0213.kro.kr/favicon.ico"
            subtitle: "Portfolio 개발 환경"
            tag: "dev"
            keywords: "개발 dev"
            url: "https://dev.minjo0213.kro.kr"
            target: "_blank"
          - name: "Joossam Dev"
            logo: "https://dev.joossameng.kro.kr/favicon.ico"
            subtitle: "Joossam 개발 환경"
            tag: "dev"
            keywords: "개발 dev"
            url: "https://dev.joossameng.kro.kr"
            target: "_blank"
      
      - name: "인프라 관리"
        icon: "fas fa-server"
        items:
          - name: "Kubernetes Dashboard"
            logo: "https://kubernetes.io/images/favicon.png"
            subtitle: "Kubernetes 관리 대시보드"
            tag: "infra"
            keywords: "kubernetes k8s"
            url: "https://kubernetes0213.kro.kr"
            target: "_blank"
          - name: "ArgoCD"
            logo: "https://argo-cd.readthedocs.io/en/stable/assets/logo.png"
            subtitle: "GitOps 배포 도구"
            tag: "infra"
            keywords: "argocd gitops"
            url: "https://argocd0213.kro.kr"
            target: "_blank"
          - name: "Grafana"
            logo: "https://grafana.com/static/img/menu/grafana2.svg"
            subtitle: "모니터링 대시보드"
            tag: "infra"
            keywords: "grafana monitoring"
            url: "https://grafana0213.kro.kr"
            target: "_blank"
          - name: "Umami"
            logo: "https://umami.is/images/logo.svg"
            subtitle: "웹사이트 분석"
            tag: "infra"
            keywords: "analytics umami"
            url: "https://umami0213.kro.kr"
            target: "_blank"
          - name: "MinIO Console"
            logo: "https://min.io/resources/img/logo.svg"
            subtitle: "S3 스토리지 관리"
            tag: "infra"
            keywords: "minio s3 storage"
            url: "https://minio.minio0213.kro.kr"
            target: "_blank"
          - name: "MinIO S3 API"
            logo: "https://min.io/resources/img/logo.svg"
            subtitle: "S3 API 엔드포인트"
            tag: "infra"
            keywords: "minio s3 api"
            url: "https://s3.minio0213.kro.kr"
            target: "_blank"
---
apiVersion: apps/v1
kind: Deployment
metadata:
  name: homer
  namespace: homer
  labels:
    app: homer
spec:
  replicas: 1
  selector:
    matchLabels:
      app: homer
  template:
    metadata:
      labels:
        app: homer
    spec:
      containers:
      - name: homer
        image: b4bz/homer:latest
        imagePullPolicy: IfNotPresent
        ports:
        - containerPort: 8080
          name: http
        volumeMounts:
        - name: config
          mountPath: "/www/assets"
        resources:
          requests:
            memory: "64Mi"
            cpu: "50m"
          limits:
            memory: "256Mi"
            cpu: "200m"
      volumes:
      - name: config
        configMap:
          name: homer-config
---
apiVersion: v1
kind: Service
metadata:
  name: homer
  namespace: homer
spec:
  type: ClusterIP
  ports:
  - name: http
    port: 80
    targetPort: 8080
  selector:
    app: homer
---
apiVersion: networking.k8s.io/v1
kind: Ingress
metadata:
  name: homer-ingress
  namespace: homer
  annotations:
    nginx.ingress.kubernetes.io/ssl-redirect: "true"
    cert-manager.io/cluster-issuer: "letsencrypt-prod"
spec:
  ingressClassName: nginx
  tls:
  - hosts:
    - mayne.kro.kr
    - www.mayne.kro.kr
    secretName: homer-tls
  rules:
  - host: mayne.kro.kr
    http:
      paths:
      - path: /
        pathType: Prefix
        backend:
          service:
            name: homer
            port:
              number: 80
  - host: www.mayne.kro.kr
    http:
      paths:
      - path: /
        pathType: Prefix
        backend:
          service:
            name: homer
            port:
              number: 80
